// Generated by Selenium IDE
const { Builder, By, Key, until } = require('selenium-webdriver')

const firefox = require('selenium-webdriver/firefox');

let driver
let vars
async function waitForWindow(timeout = 2) {
    await driver.sleep(timeout)
    const handlesThen = vars["windowHandles"]
    const handlesNow = await driver.getAllWindowHandles()
    if (handlesNow.length > handlesThen.length) {
        return handlesNow.find(handle => (!handlesThen.includes(handle)))
    }
    throw new Error("New window did not appear before timeout")
}

async function s() {




    const service = new firefox.ServiceBuilder(`${process.cwd()}/geckodriver`);
    const options = new firefox.Options();
    options.addArguments('-headless');
    driver = await new Builder().forBrowser('firefox').setFirefoxOptions(options).setFirefoxService(service).build()
    vars = {}

    await driver.get("https://yngal.com/")
    await driver.findElement(By.css("#formSign > div:nth-child(1) > input")).click()
    await driver.findElement(By.css("#formSign > div:nth-child(1) > input")).click()
    await driver.findElement(By.css("#formSign > div:nth-child(1) > input")).sendKeys(process.env.Y_USERNAME)
    await driver.findElement(By.css("#formSign > div:nth-child(2) > input")).click()
    await driver.findElement(By.css("#formSign > div:nth-child(2) > input")).sendKeys(process.env.Y_PASSWORD)

    // await driver.get("https://www.oschina.net/")
    // await driver.manage().window().setRect({ width: 550, height: 691 })
    // vars["windowHandles"] = await driver.getAllWindowHandles()
    // await driver.findElement(By.css(".panel-content__column:nth-child(1) > .tab-page:nth-child(3) .item:nth-child(1) > .item-title")).click()

   
    // vars["win3843"] = await waitForWindow(2000)
    // await driver.switchTo().window(vars["win3843"])
    // var text = await driver.findElement(By.className('article-box__title')).getText()
    // console.log(text);
    await driver.quit();
}
s();
